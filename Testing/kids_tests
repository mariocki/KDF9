SOURCE=${KDF9_USERCODE:-Assembly}
BINARY=${KDF9_BINARY:-Binary}

trap "rm -f kids_test_diff.txt"  \
      0 1 2 3

export KIDSMISC=wz
export KIDSLIST=""
>kids_tests_log.txt

kids FLUID FLUID_data t prh         >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/FLUID.k3     ${BINARY}/FLUID       ${SOURCE}/FLUID-listing.txt
kids HANOI HANOI_data t prh         >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/HANOI.k3     ${BINARY}/HANOI       ${SOURCE}/HANOI-listing.txt
kids INPUT INPUT_data t prh         >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/INPUT.k3     ${BINARY}/INPUT       ${SOURCE}/INPUT-listing.txt
kids MANORBOYX - t prh              >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/MANORBOYX.k3 ${BINARY}/MANORBOYX   ${SOURCE}/MANORBOYX-listing.txt
kids MATMULT - t prh                >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/MATMULT.k3   ${BINARY}/MATMULT     ${SOURCE}/MATMULT-listing.txt
kids PALSQR - t prh                 >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/PALSQR.k3    ${BINARY}/PALSQR      ${SOURCE}/PALSQR-listing.txt
kids PENTOMINO PENTOMINO_data t prh >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/PENTOMINO.k3 ${BINARY}/PENTOMINO   ${SOURCE}/PENTOMINO-listing.txt
kids QSORT - t prh                  >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/QSORT.k3 ${BINARY}/QSORT    ${SOURCE}/QSORT-listing.txt
kids WEEHAAVIE - t prh              >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/WEEHAAVIE.k3 ${BINARY}/WEEHAAVIE   ${SOURCE}/WEEHAAVIE-listing.txt
kids WHETSTONE - t prh              >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/WHETSTONE.k3 ${BINARY}/WHETSTONE   ${SOURCE}/WHETSTONE-listing.txt
kids ZELLER ZELLER_data t prh       >>kids_tests_log.txt
fgrep "Digital signature of traced orders = " KDF9_log.txt >>kids_tests_log.txt;
   rm ${SOURCE}/ZELLER.k3    ${BINARY}/ZELLER      ${SOURCE}/ZELLER-listing.txt

echo
diff kids_tests_log.txt kids_tests_good_log.txt >kids_test_diff.txt
if [ -s kids_test_diff.txt ]
then
   echo These are the unexpected variances for this run:
   echo ===
   more kids_test_diff.txt
   echo ===
else
   echo These tests ran as expected.
fi
