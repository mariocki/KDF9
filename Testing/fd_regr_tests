trap "rm -f fd_regr_tests_diff.txt" 0 1 2 3
opt=${1:-ahipr}

> fd_regr_tests_log.txt

echo "TEST TDISC     POA, PIA, PMA, PMF."
echo "TEST TDISC     POA, PIA, PMA, PMF." >>fd_regr_tests_log.txt
>FD0; ucc  TDISC
nine_priv  TDISC - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TDISCOR   POA, PIA, PMA, PMF."
echo "TEST TDISCOR   POA, PIA, PMA, PMF." >>fd_regr_tests_log.txt
 >FD0; ucc TDISCOR
nine_priv  TDISCOR - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TDISCEM   POB, PIA, PMA."
echo "TEST TDISCEM   POB, PIA, PMA."      >>fd_regr_tests_log.txt
>FD0; ucc  TDISCEM
nine_priv  TDISCEM - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TDISCFH   POC, PIC done."
echo "TEST TDISCFH   POC, PIC done."      >>fd_regr_tests_log.txt
>FD0; ucc  TDISCFH
nine_priv  TDISCFH - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TDISCFHNS POC, POK, PIC, PIG."
echo "TEST TDISCFHNS POC, POK, PIC, PIG." >>fd_regr_tests_log.txt
>FD0; ucc  TDISCFHNS
nine_priv  TDISCFHNS - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TFDOUTS 41, 42, 43, 44, 45."
echo "TEST TFDOUTS 41, 42, 43, 44, 45."   >>fd_regr_tests_log.txt
>FD0; ucc  TFDOUTS
nine       TFDOUTS - t ${opt}
fgrep "Digital signature"  KDF9_log.txt   >>fd_regr_tests_log.txt

echo "TEST TFDOUTFAILS 41 with no discs reserved."
echo "TEST TFDOUTFAILS 41 with no discs reserved." >>fd_regr_tests_log.txt
>FD0; ucc  TFDOUTFAILS
VARIABLE=8 nine       TFDOUTFAILS - t ${opt}
fgrep "Digital signature"  KDF9_log.txt            >>fd_regr_tests_log.txt

echo "TEST TFDOUTFAILS 44, 45 too many 45s."
echo "TEST TFDOUTFAILS 44, 45 too many 45s."       >>fd_regr_tests_log.txt
>FD0; ucc  TFDOUTFAILS
VARIABLE=4 nine       TFDOUTFAILS - t ${opt}
fgrep "Digital signature"  KDF9_log.txt            >>fd_regr_tests_log.txt

echo
diff fd_regr_tests_log.txt fd_regr_tests_good_log.txt >fd_regr_tests_diff.txt
if [ -s fd_regr_tests_diff.txt ]
then
   echo These are the unexpected variances for this run:
   echo ===
   more fd_regr_tests_diff.txt
   echo ===
else
   echo These tests ran as expected.
fi
