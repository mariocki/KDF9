BINARY=${KDF9_BINARY:-Binary}
USERCODE=${KDF9_USERCODE:-Assembly}

trap "rm -f a.out mt.out; exit 2" 1 2 3

name=`basename "$1" ".k3"`
if [ -f "${USERCODE}/$name.k3" ]
then
   kal3 ${USERCODE}/"$name.k3" > ${USERCODE}/"$name-listing.txt"
   if test -r a.out
   then
      cp a.out ${BINARY}/"$name"
   else
      echo kal3 detected error\(s\) in $name.k3
      more "$name-listing.txt"
   fi
   rm -f a.out mt.out
   exit 0
else
   echo `basename "$0"`: there is no file named "$name.k3" in the ${USERCODE} folder!
   echo
   exit 1
fi
